<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Flowchart</title>
    <style type="text/css">
        .end-element { fill : #FFCCFF; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.17.1/flowchart.min.js"></script>
</head>
<body>
    <div id="canvas"></div>
    <script>
        window.onload = function () {
            var chart;

            function drawFlowchart() {
                var code = `{{ flowchart|safe }}`;

                if (chart) {
                    chart.clean();
                }

                chart = flowchart.parse(code);
                chart.drawSVG('canvas', {
                    'x': 0,
                    'y': 0,
                    'line-width': 3,
                    'line-length': 50,
                    'text-margin': 10,
                    'font-size': 14,
                    'font': 'normal',
                    'font-family': 'Helvetica',
                    'font-weight': 'normal',
                    'font-color': 'black',
                    'line-color': 'black',
                    'element-color': 'black',
                    'fill': 'white',
                    'yes-text': 'yes',
                    'no-text': 'no',
                    'arrow-end': 'block',
                    'scale': 1,
                    'symbols': {
                        'start': {
                            'font-size': 14,
                            'font-color': 'yellow',
                            'element-color': 'blue',
                            'fill': 'green',
                            'class': 'start-element'
                        },
                        'inputoutput': {
                            'font-color': 'black',
                            'element-color': 'black',
                            'fill': 'bisque'
                        },
                        'operation': {
                            'font-color': 'black',
                            'element-color': 'black',
                            'fill': 'linen'
                        },
                        'subroutine': {
                            'font-color': 'black',
                            'element-color': 'blue',
                            'fill': 'lightgreen'
                        },
                        'condition': {
                            'font-color': 'red',
                            'element-color': 'black',
                            'fill': 'yellow'
                        },
                        'end':{
                            'font-size': 20,
                            'class': 'end-element'
                        }
                    },
                    'flowstate' : {
                        'request' : { 'fill' : 'blue'},
                        'invalid': {'fill' : '#444444'},
                        'approved' : { 'fill' : '#58C4A3', 'font-size' : 12, 'yes-text' : 'APPROVED', 'no-text' : 'n/a' },
                        'rejected' : { 'fill' : '#C45879', 'font-size' : 12, 'yes-text' : 'n/a', 'no-text' : 'REJECTED' }
                    }
                });
            }

            // Draw flowchart initially
            drawFlowchart();
        };
    </script>
</body>
</html>
